@page "/"
@using DopamineXP.Models
@inject Services.TrackerBrain Brain

<div class="tracker-container">
    <div class="main-scene">
        <div class="title-field">WELCOME TO THE TASK MANAGER</div>
        
        <div class="inputs">
            <div class="input-container">
                <span style="font-size: 20px; margin-bottom: 5px;">Write a task's name</span>
                <input type="text" class="task-input" @bind="_name"/>
            </div>
            
            <div class="input-container">
                <span style="font-size: 20px; margin-bottom: 5px;">Choose the task's color</span>
                <input type="color" class="color-input" @bind="_hexColor"/>
            </div>
            
            <div class="input-container hardcore-wrapper">
                <span style="font-size: 20px; margin-bottom: 5px;">Turn on hardcore?</span>
                <input type="checkbox" class="hardcore-input" @bind="_isHardcore"/>
            </div>
            
        </div>
            @if (_isHardcore)
            {
                <div class="hardcore-warning-container">
                    <div class="hardcore-warning-title">WARNING</div>
                    <div class="hardcore-warning-explanation">
                        Hardcore mode will require you to spend at least 60 minuted
                        on a task every day. If you don't meet this requirement -
                        your level, xp, streak and points will be reset (but not cores and shards).
                        Good luck (you will need it)
                    </div>
                </div>
            }
        
        <div class="create-task-btn" @onclick="CreateTask">CREATE THE TASK!</div>
        
        
        <div class="faq-container">
            <div class="faq-header"> F.A.Q.</div>

            <details class="faq-item task-level-item">
                <summary class="faq-question task-level-question">What is this app about?</summary>
                <div class="faq-answer task-level-answer">
                    The core of the application is simple: log the minutes you spend 
                    on a task to earn Experience Points (XP). 
                    Once you earn enough XP, you will Level Up and receive one Point. 
                    The currency name is based on the task's first letter—for example, 
                    French gives you French Points (FP), and Gym gives you Gym Points (GP).
                </div>
            </details>

            <details class="faq-item task-level-item">
                <summary class="faq-question task-level-question">What does streak give me?</summary>
                <div class="faq-answer task-level-answer">
                    Completing a task every single day builds your Streak. 
                    Your Streak acts as a massive multiplier for your XP gains, using the formula: (Streak * 0.3) + 1. 
                    This means by the 10th day of an active streak, you will be earning a massive 4x XP multiplier!
                </div>
            </details>

            <details class="faq-item task-level-item">
                <summary class="faq-question task-level-question">What is this shop?</summary>
                <div class="faq-answer task-level-answer">
                    At the beginning, the Shop contains only two items: an XP Multiplier and a Streak Freeze. 
                    Every time you buy an item, its price permanently doubles. 
                    Keep in mind that these prices won't reset for a very long time, so spend strategically. 
                    However, as long as your streak remains above zero, the system will actively reward you with 
                    one free Streak Freeze every 7 days (up to a maximum inventory of 5).
                </div>
            </details>
            
            <details class="faq-item prestige-level-item">
                <summary class="faq-question prestige-level-question">What is prestige?</summary>
                <div class="faq-answer prestige-level-answer">
                    Prestiging is your path to long-term power. When your task reaches Level 15, 
                    you undergo a Prestige: you extract a Task Core and your task's level, xp and points
                    reset to 1. While this might sound like a setback, it is actually a massive upgrade. 
                    Prestiging rewards you with a Core—a highly valuable currency - task shards - used in the Laboratory 
                    to buy permanent, game-changing upgrades. The amount of prestiges also works as a multiplier of your xp
                </div>
            </details>
        </div>
    </div>
</div>

@code {

    private string _name = "";
    private string _hexColor = "#000000";
    private bool _isHardcore = false;

    private void CreateTask()
    {
        if (string.IsNullOrWhiteSpace(_name))
            return;
        
        Brain.AddTask(
            new DopamineTask { Name = _name.Trim(), HexColor = _hexColor, Habit = new TaskHabit{IsHardcore = _isHardcore} });

        Brain.SaveToFile();
        
        _name = "";
    }
}

<style>
    .tracker-container {
        overflow-y: scroll;
        scrollbar-color: #3a3f44 #111111;
        
        background: radial-gradient(circle at top left,
        red, red, orange, yellow, green, cyan, blue, purple);

        display: flex;
        flex-direction: column;

        flex: 1;
        padding: 40px;
        color: white;
        min-height: 100vh;
        
    }
    
    .main-scene {
        background: rgba(30, 30, 30, 0.8);
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        box-sizing: border-box;
        border-radius: 15px;
        border: 2px solid white;
        box-shadow: 0 0 20px white;
    }
    
    .title-field {
        font-size: 28px;
        font-weight: 900;
        letter-spacing: 2px;
        
        display: flex;
        justify-content: center;
        margin-top: 20px;
    }
    
    .inputs {
        display: flex;
        padding: 20px;
        justify-content: space-around;
    }
    
    .input-container {
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    
    
    .task-input {
        width: 200px;
        height: 50px;

        background-color: #2e2e2e;
        color: white;
        border: 2px solid #5c5c5c;
        border-radius: 8px;
        padding: 10px 15px;
        font-size: 18px;
        font-weight: 700;
        text-align: center;
        outline: none;
        box-shadow: inset 0 4px 10px rgba(0, 0, 0, 0.5);
    }
    
    .color-input {
        width: 200px;
        height: 50px;
    }

    .input-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 20px;
        color: #ffffff;
        font-weight: 900;
        text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    }

    .hardcore-input {
        appearance: none; 
        width: 60px;
        height: 30px;
        background: #1a1a1a;
        border: 2px solid #444;
        border-radius: 15px;
        position: relative;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: inset 0 0 10px #000;
    }

    .hardcore-input::before {
        content: "";
        position: absolute;
        width: 22px;
        height: 22px;
        background: #333;
        border-radius: 50%;
        top: 2px;
        left: 2px;
        transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        box-shadow: 0 0 5px rgba(0,0,0,0.8);
    }

    .hardcore-input:hover {
        border-color: #ff1e00;
        box-shadow: 0 0 15px rgba(255, 30, 0, 0.4);
        animation: jitter 0.2s infinite;
    }

    .hardcore-input:checked {
        background: #4b0d00;
        border-color: #ff1e00;
        box-shadow: 0 0 25px #ff1e00, inset 0 0 10px #000;
        animation: jitter 0.2s infinite;
    }

    .hardcore-input:checked::before {
        left: 32px;
        background: #ff1e00;
        box-shadow: 0 0 15px #ff1e00, 0 0 30px #ff1e00;
    }

    @@keyframes jitter {
        0% { transform: translate(0, 0); }
        25% { transform: translate(1px, 1px); }
        50% { transform: translate(-1px, -1px); }
        75% { transform: translate(1px, -1px); }
        100% { transform: translate(0, 0); } 
    }

    .hardcore-warning-title {
        color: #ff0000;
        font-size: 32px;
        font-weight: 900;
        letter-spacing: 8px;
        text-align: center;
        margin-top: 20px;
        text-shadow: 0 0 10px #ff0000, 0 0 20px #ff0000;
    }

    .hardcore-warning-explanation {
        background: rgba(20, 0, 0, 0.9);
        border-left: 5px solid #ff1e00;
        padding: 20px;
        width: 85%;
        max-width: 500px;
        color: #cccccc;
        font-family: 'Courier New', Courier, monospace; 
        font-size: 14px;
        line-height: 1.6;
        text-align: left;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        border-radius: 0 8px 8px 0;
        position: relative;
        overflow: hidden;
    }

    .hardcore-warning-container {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .inputs {
        display: grid;
        grid-template-columns: 1fr 1fr;
        align-items: center;
        gap: 20px;
    }

    .hardcore-wrapper {
        grid-column: span 2;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    
    

    /*CUSTOM ADD A TASK BUTTON FIELD//////////*/
    .create-task-btn {
        text-decoration: none;
        position: relative;
        padding: 14px 40px;
        font-size: 18px;
        font-weight: 700;
        color: white;
        background: #1e1e1e;
        border: none;
        border-radius: 14px;
        cursor: pointer;
        overflow: hidden;
        z-index: 1;
        transition: transform 0.2s ease, box-shadow 0.3s ease;
        
        text-align: center;
        margin: 50px auto 50px auto;
        width: 300px;
    }

    .create-task-btn::before {
        content: "";
        position: absolute;
        inset: -3px;
        border-radius: inherit;
        background: linear-gradient(
            90deg,
            red,
            orange,
            yellow,
            lime,
            cyan,
            blue,
            violet,
            red
        );
        background-size: 300% 100%;
        animation: rainbowMove 4s linear infinite;
        z-index: -2;
    }

    .create-task-btn::after {
        content: "";
        position: absolute;
        inset: 3px;
        background: #1e1e1e;
        border-radius: inherit;
        z-index: -1;
    }

    .create-task-btn:hover {
        transform: translateY(-4px);
        box-shadow: 0 0 20px rgba(255, 0, 255, 0.4),
        0 0 40px rgba(0, 255, 255, 0.3);
    }

    .create-task-btn:active {
        transform: scale(0.96);
    }

    @@keyframes rainbowMove {
        0% { background-position: 0% 50%; }
        100% { background-position: 300% 50%; }
    }
    /*CUSTOM ADD A TASK BUTTON FIELD//////////*/

    .faq-container {
        margin-top: 60px;
        padding: 20px;
        border-top: 2px dashed #333333;
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .faq-header {
        color: #ffffff;
        font-family: monospace;
        font-size: 18px;
        font-weight: 900;
        letter-spacing: 3px;
        text-align: center;
        margin-bottom: 10px;
    }

    .faq-item {
        background-color: rgba(20, 20, 20, 0.8);
        border: 1px solid #333333;
        border-radius: 12px;
        overflow: hidden;
        transition: all 0.3s ease;
    }


    .faq-question {
        padding: 18px 20px;
        font-family: monospace;
        font-weight: bold;
        font-size: 16px;
        cursor: pointer;
        list-style: none; 
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .faq-question::-webkit-details-marker {
        display: none;
    }

    .faq-question::after {
        content: '+';
        color: #666;
        font-size: 20px;
    }

    .faq-item[open] .faq-question::after {
        content: '−';
    }

    .faq-answer {
        padding: 0 20px 20px 20px;
        color: #aaaaaa;
        line-height: 1.6;
        font-size: 14px;
        margin-top: -5px;
        padding-top: 15px;
    }
    
    .task-level-item[open] {
        border-color: #00aaff;
        box-shadow: 0 0 15px rgba(0, 170, 255, 0.1);
    }

    .task-level-question {
        color: #00aaff;
    }
    
    .task-level-question[open] .task-level-question::after {
        color: #00aaff;
    }
    
    .task-level-answer {
        border-top: 1px solid rgba(0, 170, 255, 0.2);
    }


    .prestige-level-item[open] {
        border-color: #ff6a00;
        box-shadow: 0 0 15px rgba(0, 170, 255, 0.1);
    }

    .prestige-level-question {
        color: #ff6a00;
    }

    .prestige-level-question[open] .task-level-question::after {
        color: #ff6a00;
    }

    .prestige-level-answer {
        border-top: 1px solid rgb(255, 106, 0, 0.2);
    }
    
    @@media (max-width: 768px) {
        .tracker-container {
            padding: 15px; 
            
        }

        .title-field {
            font-size: 20px; 
            text-align: center;
            padding: 0 10px;
        }

        .task-input, .color-input {
            width: 100%; 
            max-width: 250px; 
        }

        .create-task-btn {
            width: 100%;
            max-width: 280px; 
            margin-top: 30px;
        }
    }
    
</style>